# SRT 예매 매크로

SRT 기차표 예매를 자동화하는 파이썬 매크로입니다. Selenium을 사용하여 웹 브라우저를 제어하며, 사용자가 설정한 조건에 따라 기차표를 검색하고 자동으로 예약을 시도합니다.
명절표 구할때 썼어요~

## 기능

- **자동 로그인**: SRT 아이디와 비밀번호를 입력하여 자동으로 로그인합니다.
- **다양한 검색 조건**: 출발지, 도착지, 날짜, 시간, 인원 수를 설정할 수 있습니다.
- **유연한 예매 전략**:
  - **특정 시간 지정**: 정확히 원하는 시간의 기차만 예매합니다.
  - **시간 범위 검색**: 특정 시간대(예: 08:00 ~ 10:00) 사이의 모든 기차를 대상으로 예매를 시도합니다.
  - **빠른 예매**: 특정 시간 이후 예약 가능한 가장 빠른 기차를 예매합니다.
- **자동 새로고침**: 매진된 표가 생길 때까지 페이지를 자동으로 새로고침하며 대기합니다.

## 설치 및 준비사항

이 프로젝트를 실행하기 위해서는 **Python 3.8 이상**의 환경이 필요합니다.

### 1. 라이브러리 설치

필요한 Python 패키지를 설치합니다.

```bash
pip install -r requirements.txt
```

### 2. Chrome 브라우저

본 매크로는 Chrome 브라우저를 사용합니다. 컴퓨터에 Chrome 브라우저가 설치되어 있어야 합니다. (ChromeDriver는 `webdriver-manager`가 자동으로 관리하므로 별도로 다운로드할 필요가 없습니다.)

## 사용 방법

`srt_reservation.py` 파일을 열고, 파일 하단의 `if __name__ == "__main__":` 블록을 수정하여 사용합니다.

### 기본 실행 코드 예시

```python
from srt_reservation import SRTReservation

# 1. SRT 로그인 정보 설정
srt_id = "1234567890"  # 본인의 SRT 회원번호 (숫자만 입력)
srt_pw = "password123!"  # 본인의 SRT 비밀번호

# 2. 매크로 인스턴스 생성 및 로그인
srt = SRTReservation(headless=False) # headless=True로 설정하면 브라우저 창 없이 실행됩니다.
srt.login(srt_id, srt_pw)

# 3. 예매 함수 실행 (아래 상세 설명 참고)
srt.search_train(...) 
```

### `srt.search_train` 사용 가이드 (모든 경우의 수)

`search_train` 함수는 파이썬 스크립트 내에서 호출하며, 제공하는 파라미터 조합에 따라 3가지 모드로 작동합니다.

**공통 파라미터:**
- `departure`: 출발역 (예: "수서", "부산", "동대구", "대전")
- `arrival`: 도착역 (예: "동대구", "부산", "수서")
- `date`: 날짜 (YYYYMMDD 형식 문자열, 예: "20260217")
- `time_str`: 검색 시작 시간 (HHMMSS 형식, 가급적 짝수 시간 사용, 예: "080000")
- `adults`: 성인 인원 수 (문자열, 기본값 "1")

---

#### 사용 사례 1: "난 죽어도 이 시간 기차만 타야겠다" (특정 시간 지정)
`target_time` 파라미터를 설정하면 해당 시간의 기차만 노립니다.

```python
# 08:00 출발 기차만 예매 시도
srt.search_train(
    departure="수서",
    arrival="부산",
    date="20260217",
    time_str="080000",    # 8시부터 조회 시작
    target_time="08:00",  # [중요] 정확히 08:00 기차만 찾음
    adults="1"
)
```

#### 사용 사례 2: "이 시간대 사이면 아무거나 괜찮아" (시간 범위 지정)
`time_limit` 파라미터를 설정하여 `time_str` 부터 `time_limit` 사이의 기차를 예매합니다. 출근 시간, 공연 시간 등 도착 리미트가 있을 때 유용합니다.

```python
# 13:00 부터 15:00 전까지 출발하는 기차 중 예약 가능한 것 예매
srt.search_train(
    departure="동대구",
    arrival="수서",
    date="20260217",
    time_str="130000",   # 13시 00분 이후 출발
    time_limit="150000", # 15시 00분 이전 출발 (15:00 미포함)
    adults="2"
)
```

#### 사용 사례 3: "그냥 지금 갈 수 있는 가장 빠른거!" (특정 시간 이후 순차 검색)
`target_time`과 `time_limit`을 모두 비워두면, `time_str` 이후 조회되는 목록에서 **예약 가능한 버튼이 보이는 즉시** 예매합니다.

```python
# 18:00 이후 출발하는 모든 기차 중 가장 먼저 잡히는 표 예매
srt.search_train(
    departure="수서",
    arrival="광주송정",
    date="20260217",
    time_str="180000",  # 18시 이후 조회
    adults="1"
    # target_time, time_limit 생략
)
```

## 참고 사항

- **예약 성공 확인**: 터미널(콘솔) 화면에 "예약 성공 가능성이 높습니다!" 메시지가 뜨면 소리가 나거나 하지는 않으므로 화면을 확인해 주세요.
- **결제**: 이 매크로는 **예약(좌석 선점)**까지만 수행합니다. 결제는 예약 완료 후 20분 내에 직접 SRT 앱이나 웹사이트에서 진행해야 합니다.
- **매크로 감지**: 과도한 새로고침은 일시적인 접속 차단을 유발할 수 있습니다. 스크립트 내부에는 이를 방지하기 위한 대기 시간(sleep)이 포함되어 있습니다.
